<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
</head>
<body>

<div class="container">     
  <table class="table table-dark table-hover">
 <h1>User Management System</h1>
    <button class="btn btn-warning" id="createUser">Generate New User</button>
    <thead>
      <tr>
        <th>id</th>
        <th>name</th>
        <th>gender</th>
        <th>Email</th>
        <th>address</th>
        <th>action</th>
      </tr>
    </thead>
    <tbody id="users">
    </tbody>
  </table>
</div>
<script type="text/javascript">
  $(document).ready(function(){
      // $('.dlUser').click(function(){
      //   deleteUser(this.id);
      //   $(this).parent('tr').remove();
      // });
      $('#createUser').click(function() {
        create();
      })
  });
  
  get();
  
  function get() {
      $.ajax({
          method : 'GET', 
          url : "http://localhost:2020/users", 
          beforeSend: function(){
              console.log("sending...");
          },
          timeout: 5000,
          success:function(response){
        	console.log("completed")
            for(i = 0; i<response.length; i++) {
              $body = `
                    <tr>
                  <td>`+response[i].id +`</td>
                  <td>`+response[i].name +`</td>
                  <td>`+response[i].gender +`</td>
                  <td>`+response[i].email +`</td>
                  <td>`+response[i].address +`</td>
                  <td><button class="btn btn-danger col-md-12 dlUser" onClick="deleteUser(`+ response[i].id +`)" id="`+ response[i].id +`">delete</button></td>
                    </tr>
                  `;
                $("#users").append($body);
            }
          },
          error : function(error){
          }
      });
  }

  function create() {
      $.ajax({
          method : 'POST', 
          url : "http://localhost:2020/users", 
          beforeSend: function(){
              console.log("sending...");
          },
          timeout: 5000,
          success:function(response){
        	  console.log("completed")
              $body = `
                    <tr>
                  <td>`+response.id +`</td>
                  <td>`+response.name +`</td>
                  <td>`+response.gender +`</td>
                  <td>`+response.email +`</td>
                  <td>`+response.address +`</td>
                  <td><button class="btn btn-danger col-md-12 dlUser" onClick="deleteUser(`+ response.id +`)" id="`+ response.id +`">delete</button></td>
                    </tr>
                  `;
                $("#users").append($body);
          },
          error : function(error){
          }
      });
  }
  function deleteUser($id) {
    $.ajax({
          method : 'DELETE', 
          url : "http://localhost:2020/users/"+$id,
          beforeSend: function(){
              console.log("sending...");
          },
          timeout: 5000,
          success:function(response){
        	console.log("completed")
            alert(response);
          },
          error : function(error) {
            alert(error);
          }
      });
  }
</script>

</body>
</html>
